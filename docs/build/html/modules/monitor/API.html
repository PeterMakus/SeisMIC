

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>miic3.monitor API &mdash; SeisMIIC 0.1 documentation</title>
  

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script src="https://unpkg.com/mermaid/dist/mermaid.min.js"></script>
        <script >mermaid.initialize({startOnLoad:true});</script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="prev" title="Reading and Handling of DV objects" href="dv.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../index.html" class="icon icon-home"> SeisMIIC
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../intro.html">Introduction: Noise Interferometry with Green’s Function Retrieval</a></li>
<li class="toctree-l1"><a class="reference internal" href="../trace_data.html">Trace data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../correlate.html">Compute and Handle Correlations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../corrdb.html">Save and Load Correlations</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../monitor.html">Monitor Velocity Changes</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="monitor.html">Compute Velocity Changes</a></li>
<li class="toctree-l2"><a class="reference internal" href="dv.html">Reading and Handling of DV objects</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#"><code class="docutils literal notranslate"><span class="pre">miic3.monitor</span></code> API</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#miic3-monitor-monitor">miic3.monitor.monitor</a></li>
<li class="toctree-l3"><a class="reference internal" href="#miic3-monitor-dv">miic3.monitor.dv</a></li>
<li class="toctree-l3"><a class="reference internal" href="#miic3-monitor-post-corr-process">miic3.monitor.post_corr_process</a></li>
<li class="toctree-l3"><a class="reference internal" href="#miic3-monitor-stretch-mod">miic3.monitor.stretch_mod</a></li>
</ul>
</li>
</ul>
</li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">SeisMIIC</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="../monitor.html">Monitor Velocity Changes</a> &raquo;</li>
        
      <li><code class="docutils literal notranslate"><span class="pre">miic3.monitor</span></code> API</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../../_sources/modules/monitor/API.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="miic3-monitor-api">
<span id="api-label"></span><h1><code class="docutils literal notranslate"><span class="pre">miic3.monitor</span></code> API<a class="headerlink" href="#miic3-monitor-api" title="Permalink to this headline">¶</a></h1>
<div class="section" id="miic3-monitor-monitor">
<h2>miic3.monitor.monitor<a class="headerlink" href="#miic3-monitor-monitor" title="Permalink to this headline">¶</a></h2>
<p>Compute seismic velocity changes</p>
<span class="target" id="module-miic3.monitor.monitor"></span><dl class="field-list simple">
<dt class="field-odd">copyright</dt>
<dd class="field-odd"><p></p></dd>
<dt class="field-even">license</dt>
<dd class="field-even"><p>GNU Lesser General Public License, Version 3
(<a class="reference external" href="https://www.gnu.org/copyleft/lesser.html">https://www.gnu.org/copyleft/lesser.html</a>)</p>
</dd>
<dt class="field-odd">author</dt>
<dd class="field-odd"><p>Peter Makus (<a class="reference external" href="mailto:makus&#37;&#52;&#48;gfz-potsdam&#46;de">makus<span>&#64;</span>gfz-potsdam<span>&#46;</span>de</a>)</p>
</dd>
</dl>
<p>Created: Thursday, 3rd June 2021 04:15:57 pm
Last Modified: Friday, 16th July 2021 04:23:17 pm</p>
<dl class="py class">
<dt id="miic3.monitor.monitor.Monitor">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">miic3.monitor.monitor.</span></code><code class="sig-name descname"><span class="pre">Monitor</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">options</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">dict</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/miic3/monitor/monitor.html#Monitor"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#miic3.monitor.monitor.Monitor" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py method">
<dt id="miic3.monitor.monitor.Monitor.compute_velocity_change">
<code class="sig-name descname"><span class="pre">compute_velocity_change</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">corr_file</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tag</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">network</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">station</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">channel</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/miic3/monitor/monitor.html#Monitor.compute_velocity_change"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#miic3.monitor.monitor.Monitor.compute_velocity_change" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="miic3.monitor.monitor.Monitor.compute_velocity_change_bulk">
<code class="sig-name descname"><span class="pre">compute_velocity_change_bulk</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/miic3/monitor/monitor.html#Monitor.compute_velocity_change_bulk"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#miic3.monitor.monitor.Monitor.compute_velocity_change_bulk" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt id="miic3.monitor.monitor.make_time_list">
<code class="sig-prename descclassname"><span class="pre">miic3.monitor.monitor.</span></code><code class="sig-name descname"><span class="pre">make_time_list</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">start_date</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">end_date</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">date_inc</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">win_len</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> &#x2192; <span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">,</span> </span><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">]</span></span><a class="reference internal" href="../../_modules/miic3/monitor/monitor.html#make_time_list"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#miic3.monitor.monitor.make_time_list" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns numpy array of starttimes and endtimes, for which each data point
of velocity change should be computed.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>start_date</strong> (<em>str</em>) – Date (including time) to start monitoring</p></li>
<li><p><strong>end_date</strong> (<em>str</em>) – Last date (including time) of monitoring</p></li>
<li><p><strong>date_inc</strong> (<em>int</em>) – Increment in seconds between each datapoint</p></li>
<li><p><strong>win_len</strong> (<em>int</em>) – Window Length, for which each data point is computed.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A numpy array holding the starttimes and endtimes of the computing
time windows in seconds (as UTC timestamps)</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Tuple[ np.ndarray, np.ndarray]</p>
</dd>
</dl>
<p>..note:: see <cite>obspy’s documentation &lt;https://docs.obspy.org/packages/autogen/obspy.core.utcdatetime.UTCDateTime.html&gt;</cite>
for compatible input strings.</p>
</dd></dl>

</div>
<div class="section" id="miic3-monitor-dv">
<h2>miic3.monitor.dv<a class="headerlink" href="#miic3-monitor-dv" title="Permalink to this headline">¶</a></h2>
<p>Module to handle velocity change objects.</p>
<span class="target" id="module-miic3.monitor.dv"></span><dl class="field-list simple">
<dt class="field-odd">copyright</dt>
<dd class="field-odd"><p>The PyGLImER development team (<a class="reference external" href="mailto:makus&#37;&#52;&#48;gfz-potsdam&#46;de">makus<span>&#64;</span>gfz-potsdam<span>&#46;</span>de</a>).</p>
</dd>
<dt class="field-even">license</dt>
<dd class="field-even"><p>GNU Lesser General Public License, Version 3
(<a class="reference external" href="https://www.gnu.org/copyleft/lesser.html">https://www.gnu.org/copyleft/lesser.html</a>)</p>
</dd>
<dt class="field-odd">author</dt>
<dd class="field-odd"><p>Peter Makus (<a class="reference external" href="mailto:makus&#37;&#52;&#48;gfz-potsdam&#46;de">makus<span>&#64;</span>gfz-potsdam<span>&#46;</span>de</a>)</p>
</dd>
</dl>
<p>Created: Tuesday, 15th June 2021 04:12:18 pm
Last Modified: Friday, 16th July 2021 02:36:59 pm</p>
<dl class="py class">
<dt id="miic3.monitor.dv.DV">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">miic3.monitor.dv.</span></code><code class="sig-name descname"><span class="pre">DV</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">corr</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">value</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">value_type</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sim_mat</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">second_axis</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stats</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="../correlate/API.html#miic3.correlate.stats.CorrStats" title="miic3.correlate.stats.CorrStats"><span class="pre">miic3.correlate.stats.CorrStats</span></a></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/miic3/monitor/dv.html#DV"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#miic3.monitor.dv.DV" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>A simple object to save velocity changes.</p>
<dl class="py method">
<dt id="miic3.monitor.dv.DV.save">
<code class="sig-name descname"><span class="pre">save</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/miic3/monitor/dv.html#DV.save"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#miic3.monitor.dv.DV.save" title="Permalink to this definition">¶</a></dt>
<dd><p>Saves the dv object to a compressed numpy binary format. The DV can
later be read using <a class="reference internal" href="#miic3.monitor.dv.read_dv" title="miic3.monitor.dv.read_dv"><code class="xref py py-func docutils literal notranslate"><span class="pre">read_dv()</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>path</strong> (<em>str</em>) – output path</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="miic3.monitor.dv.DV.plot">
<code class="sig-name descname"><span class="pre">plot</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">save_dir</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">'.'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figure_file_name</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mark_time</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">datetime.datetime</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalize_simmat</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">bool</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sim_mat_Clim</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">,</span> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">(9,</span> <span class="pre">11)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dpi</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">72</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/miic3/monitor/dv.html#DV.plot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#miic3.monitor.dv.DV.plot" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt id="miic3.monitor.dv.read_dv">
<code class="sig-prename descclassname"><span class="pre">miic3.monitor.dv.</span></code><code class="sig-name descname"><span class="pre">read_dv</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> &#x2192; <a class="reference internal" href="#miic3.monitor.dv.DV" title="miic3.monitor.dv.DV"><span class="pre">miic3.monitor.dv.DV</span></a><a class="reference internal" href="../../_modules/miic3/monitor/dv.html#read_dv"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#miic3.monitor.dv.read_dv" title="Permalink to this definition">¶</a></dt>
<dd><p>Reads a saved velocity change object from an <strong>.npz</strong> file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>path</strong> (<em>str</em>) – Path to file</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the corresponding and converted DV object</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#miic3.monitor.dv.DV" title="miic3.monitor.dv.DV">DV</a></p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="miic3-monitor-post-corr-process">
<h2>miic3.monitor.post_corr_process<a class="headerlink" href="#miic3-monitor-post-corr-process" title="Permalink to this headline">¶</a></h2>
<p>Holds the postprocessing functions for CorrBulks.</p>
<span class="target" id="module-miic3.monitor.post_corr_process"></span><dl class="field-list">
<dt class="field-odd">copyright</dt>
<dd class="field-odd"><p></p></dd>
<dt class="field-even">license</dt>
<dd class="field-even"><p>GNU Lesser General Public License, Version 3
(<a class="reference external" href="https://www.gnu.org/copyleft/lesser.html">https://www.gnu.org/copyleft/lesser.html</a>)</p>
</dd>
<dt class="field-odd">author</dt>
<dd class="field-odd"><blockquote>
<div><p>Christoph Sens-Schönefelder</p>
</div></blockquote>
<p>Peter Makus (<a class="reference external" href="mailto:makus&#37;&#52;&#48;gfz-potsdam&#46;de">makus<span>&#64;</span>gfz-potsdam<span>&#46;</span>de</a>)</p>
</dd>
</dl>
<p>Created: Monday, 14th June 2021 08:50:57 am
Last Modified: Tuesday, 20th July 2021 04:25:42 pm</p>
<dl class="py function">
<dt id="miic3.monitor.post_corr_process.corr_mat_smooth">
<code class="sig-prename descclassname"><span class="pre">miic3.monitor.post_corr_process.</span></code><code class="sig-name descname"><span class="pre">corr_mat_smooth</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wsize</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wtype</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">'flat'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span> &#x2192; <span class="pre">numpy.ndarray</span><a class="reference internal" href="../../_modules/miic3/monitor/post_corr_process.html#corr_mat_smooth"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#miic3.monitor.post_corr_process.corr_mat_smooth" title="Permalink to this definition">¶</a></dt>
<dd><p>Smoothing of a correlation matrix.</p>
<p>Smoothes the correlation matrix with a given window function of the given
width along the given axis. This method is based on the convolution of a
scaled window with the signal. Each row/col (i.e. depending on the selected
<code class="docutils literal notranslate"><span class="pre">axis</span></code>) is “prepared” by introducing reflected copies of it (with the
window size) in both ends so that transient parts are minimized in the
beginning and end part of the resulting array.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>corr_mat</strong> (<em>dictionary of the type correlation matrix</em>) – correlation matrix to be smoothed</p></li>
<li><p><strong>wsize</strong> (<em>int</em>) – Window size</p></li>
<li><p><strong>wtype</strong> (<em>string</em>) – Window type. It can be one of:
[‘flat’, ‘hanning’, ‘hamming’, ‘bartlett’, ‘blackman’] defaults to
‘flat’</p></li>
<li><p><strong>axis</strong> (<em>int</em>) – Axis along with apply the filter. O: smooth along correlation
lag time axis 1: smooth along time axis</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><strong>X</strong>: Filtered matrix</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="miic3.monitor.post_corr_process.unicode_to_string">
<code class="sig-prename descclassname"><span class="pre">miic3.monitor.post_corr_process.</span></code><code class="sig-name descname"><span class="pre">unicode_to_string</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/miic3/monitor/post_corr_process.html#unicode_to_string"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#miic3.monitor.post_corr_process.unicode_to_string" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert all unicode strings to utf-8 strings</p>
</dd></dl>

<dl class="py function">
<dt id="miic3.monitor.post_corr_process.corr_mat_filter">
<code class="sig-prename descclassname"><span class="pre">miic3.monitor.post_corr_process.</span></code><code class="sig-name descname"><span class="pre">corr_mat_filter</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stats</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="../correlate/API.html#miic3.correlate.stats.CorrStats" title="miic3.correlate.stats.CorrStats"><span class="pre">miic3.correlate.stats.CorrStats</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">freqs</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">,</span> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">order</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em><span class="sig-paren">)</span> &#x2192; <span class="pre">numpy.ndarray</span><a class="reference internal" href="../../_modules/miic3/monitor/post_corr_process.html#corr_mat_filter"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#miic3.monitor.post_corr_process.corr_mat_filter" title="Permalink to this definition">¶</a></dt>
<dd><p>Filter a correlation matrix.</p>
<p>Filters the correlation matrix corr_mat in the frequency band specified in
freqs using a zero phase filter of twice the order given in order.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>np.ndarray</em>) – correlation matrix</p></li>
<li><p><strong>stats</strong> (<a class="reference internal" href="../correlate/API.html#miic3.correlate.stats.CorrStats" title="miic3.correlate.stats.CorrStats"><code class="xref py py-class docutils literal notranslate"><span class="pre">CorrStats</span></code></a>) – The stats object corresponding to the CorrBulk object</p></li>
<li><p><strong>freqs</strong> (<em>array-like of length 2</em>) – lower and upper limits of the pass band in Hertz</p></li>
<li><p><strong>order</strong> (<em>int</em>) – half the order of the Butterworth filter</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>np.ndarray</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>filtered correlation matrix</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="miic3.monitor.post_corr_process.corr_mat_trim">
<code class="sig-prename descclassname"><span class="pre">miic3.monitor.post_corr_process.</span></code><code class="sig-name descname"><span class="pre">corr_mat_trim</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stats</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="../correlate/API.html#miic3.correlate.stats.CorrStats" title="miic3.correlate.stats.CorrStats"><span class="pre">miic3.correlate.stats.CorrStats</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">starttime</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">endtime</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">float</span></span></em><span class="sig-paren">)</span> &#x2192; <span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">,</span> </span><a class="reference internal" href="../correlate/API.html#miic3.correlate.stats.CorrStats" title="miic3.correlate.stats.CorrStats"><span class="pre">miic3.correlate.stats.CorrStats</span></a><span class="p"><span class="pre">]</span></span><a class="reference internal" href="../../_modules/miic3/monitor/post_corr_process.html#corr_mat_trim"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#miic3.monitor.post_corr_process.corr_mat_trim" title="Permalink to this definition">¶</a></dt>
<dd><p>Trim the correlation matrix to a given period.</p>
<p>Trim the correlation matrix <cite>corr_mat</cite> to the period from <cite>starttime</cite> to
<cite>endtime</cite> given in seconds from the zero position, so both can be
positive and negative. If <cite>starttime</cite> and <cite>endtime</cite> are datetime.datetime
objects they are taken as absolute start and endtime.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>corr_mat</strong> – correlation matrix to be trimmed</p></li>
<li><p><strong>starttime</strong> (<em>float</em>) – start time in seconds with respect to the zero position</p></li>
<li><p><strong>order</strong> – end time in seconds with respect to the zero position</p></li>
</ul>
</dd>
<dt class="field-even">Rtype tuple</dt>
<dd class="field-even"><p>Tuple[np.ndarray, CorrStats]</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>trimmed correlation matrix and new stats object</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="miic3.monitor.post_corr_process.corr_mat_resample">
<code class="sig-prename descclassname"><span class="pre">miic3.monitor.post_corr_process.</span></code><code class="sig-name descname"><span class="pre">corr_mat_resample</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stats</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="../correlate/API.html#miic3.correlate.stats.CorrStats" title="miic3.correlate.stats.CorrStats"><span class="pre">miic3.correlate.stats.CorrStats</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">start_times</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">obspy.core.utcdatetime.UTCDateTime</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">end_times</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em><span class="sig-paren">)</span> &#x2192; <span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">,</span> </span><a class="reference internal" href="../correlate/API.html#miic3.correlate.stats.CorrStats" title="miic3.correlate.stats.CorrStats"><span class="pre">miic3.correlate.stats.CorrStats</span></a><span class="p"><span class="pre">]</span></span><a class="reference internal" href="../../_modules/miic3/monitor/post_corr_process.html#corr_mat_resample"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#miic3.monitor.post_corr_process.corr_mat_resample" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to create correlation matrices with constant sampling</p>
<p>When created with recombine_corr_data the correlation matrix contains all
available correlation streams but homogeneous sampling is not guaranteed
as correlation functions may be missing due to data gaps. This function
restructures the correlation matrix by inserting or averaging correlation
functions to provide temporally homogeneous sampling. Inserted correlation
functions consist of ‘nan’ if gaps are present and averaging is done if
more than one correlation function falls in a bin between start_times[i]
and end_times[i]. If end_time is an empty list (default) end_times[i] is
set to start_times[i] + (start_times[1] - start_times[0])</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>np.ndarray</em>) – 2D matrix holding the correlation data</p></li>
<li><p><strong>Stats</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Stats</span></code>) – The stats object belonging to the
<code class="xref py py-class docutils literal notranslate"><span class="pre">CorrBulk</span></code> object.</p></li>
<li><p><strong>start_times</strong> (list of <code class="xref py py-class docutils literal notranslate"><span class="pre">UTCDateTime</span></code> objects) – list of starting times for the bins of the new
sampling</p></li>
<li><p><strong>end_times</strong> (list of <code class="xref py py-class docutils literal notranslate"><span class="pre">UTCDateTime</span></code> objects) – list of starting times for the bins of the new sampling</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>tuple</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>the new data array and altered stats object.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="miic3.monitor.post_corr_process.corr_mat_correct_decay">
<code class="sig-prename descclassname"><span class="pre">miic3.monitor.post_corr_process.</span></code><code class="sig-name descname"><span class="pre">corr_mat_correct_decay</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stats</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="../correlate/API.html#miic3.correlate.stats.CorrStats" title="miic3.correlate.stats.CorrStats"><span class="pre">miic3.correlate.stats.CorrStats</span></a></span></em><span class="sig-paren">)</span> &#x2192; <span class="pre">numpy.ndarray</span><a class="reference internal" href="../../_modules/miic3/monitor/post_corr_process.html#corr_mat_correct_decay"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#miic3.monitor.post_corr_process.corr_mat_correct_decay" title="Permalink to this definition">¶</a></dt>
<dd><p>Correct for the amplitude decay in a correlation matrix.</p>
<p>Due to attenuation and geometrical spreading the amplitude of the
correlations decays with increasing lapse time. This decay is corrected
by dividing the correlation functions by an exponential function that
models the decay.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>np.ndarray</em>) – Matrix holding correlation data</p></li>
<li><p><strong>stats</strong> (<a class="reference internal" href="../correlate/API.html#miic3.correlate.stats.CorrStats" title="miic3.correlate.stats.CorrStats"><em>CorrStats</em></a>) – Stats object afiliated to a CorrBulk object</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>correlations with decay corrected amplitudes</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="miic3.monitor.post_corr_process.corr_mat_envelope">
<code class="sig-prename descclassname"><span class="pre">miic3.monitor.post_corr_process.</span></code><code class="sig-name descname"><span class="pre">corr_mat_envelope</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">numpy.ndarray</span></span></em><span class="sig-paren">)</span> &#x2192; <span class="pre">numpy.ndarray</span><a class="reference internal" href="../../_modules/miic3/monitor/post_corr_process.html#corr_mat_envelope"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#miic3.monitor.post_corr_process.corr_mat_envelope" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the envelope of a correlation matrix.</p>
<p>The corrlation data of the correlation matrix are replaced by their
Hilbert envelopes.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>data</strong> (<em>np.ndarray</em>) – correlation matrix.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>np.ndarray</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><strong>hilb</strong>: The envelope of the correlation data in the same shape
as the input array.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="miic3.monitor.post_corr_process.corr_mat_normalize">
<code class="sig-prename descclassname"><span class="pre">miic3.monitor.post_corr_process.</span></code><code class="sig-name descname"><span class="pre">corr_mat_normalize</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stats</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="../correlate/API.html#miic3.correlate.stats.CorrStats" title="miic3.correlate.stats.CorrStats"><span class="pre">miic3.correlate.stats.CorrStats</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">starttime</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">endtime</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normtype</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">'energy'</span></span></em><span class="sig-paren">)</span> &#x2192; <span class="pre">numpy.ndarray</span><a class="reference internal" href="../../_modules/miic3/monitor/post_corr_process.html#corr_mat_normalize"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#miic3.monitor.post_corr_process.corr_mat_normalize" title="Permalink to this definition">¶</a></dt>
<dd><p>Correct amplitude variations with time in a correlation matrix.</p>
<p>Measure the maximum of the absolute value of the correlation matrix in
a specified lapse time window and normalize the correlation traces by
this values. A coherent phase in the respective lapse time window will
have constant ampitude afterwards..</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>np.ndarray</em>) – correlation matrix from CorrBulk</p></li>
<li><p><strong>stats</strong> (<a class="reference internal" href="../correlate/API.html#miic3.correlate.stats.CorrStats" title="miic3.correlate.stats.CorrStats"><code class="xref py py-class docutils literal notranslate"><span class="pre">CorrStats</span></code></a>) – The stats object from the
<code class="xref py py-class docutils literal notranslate"><span class="pre">CorrBulk</span></code> object.</p></li>
<li><p><strong>starttime</strong> (<em>float</em>) – beginning of time window in seconds with respect to the
zero position</p></li>
<li><p><strong>endtime</strong> (<em>float</em>) – end time window in seconds with respect to the zero
position</p></li>
<li><p><strong>normtype</strong> (<em>string</em>) – one of the following ‘energy’, ‘max’, ‘absmax’, ‘abssum’
to decide about the way to calculate the normalization.</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>np.ndarray</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Correlation matrix with normalized ampitudes.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="miic3.monitor.post_corr_process.corr_mat_mirror">
<code class="sig-prename descclassname"><span class="pre">miic3.monitor.post_corr_process.</span></code><code class="sig-name descname"><span class="pre">corr_mat_mirror</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stats</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="../correlate/API.html#miic3.correlate.stats.CorrStats" title="miic3.correlate.stats.CorrStats"><span class="pre">miic3.correlate.stats.CorrStats</span></a></span></em><span class="sig-paren">)</span> &#x2192; <span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">,</span> </span><a class="reference internal" href="../correlate/API.html#miic3.correlate.stats.CorrStats" title="miic3.correlate.stats.CorrStats"><span class="pre">miic3.correlate.stats.CorrStats</span></a><span class="p"><span class="pre">]</span></span><a class="reference internal" href="../../_modules/miic3/monitor/post_corr_process.html#corr_mat_mirror"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#miic3.monitor.post_corr_process.corr_mat_mirror" title="Permalink to this definition">¶</a></dt>
<dd><p>Average the causal and acausal parts of a correlation matrix.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>np.ndarray</em>) – A matrix holding correlation data</p></li>
<li><p><strong>stats</strong> (<a class="reference internal" href="../correlate/API.html#miic3.correlate.stats.CorrStats" title="miic3.correlate.stats.CorrStats"><em>CorrStats</em></a>) – the stats object corresponding to a CorrBulk object.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>as the input but with
avaraged causal and acausal parts of the correlation data</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Tuple[np.ndarray, <a class="reference internal" href="../correlate/API.html#miic3.correlate.stats.CorrStats" title="miic3.correlate.stats.CorrStats">CorrStats</a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="miic3.monitor.post_corr_process.corr_mat_taper">
<code class="sig-prename descclassname"><span class="pre">miic3.monitor.post_corr_process.</span></code><code class="sig-name descname"><span class="pre">corr_mat_taper</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stats</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="../correlate/API.html#miic3.correlate.stats.CorrStats" title="miic3.correlate.stats.CorrStats"><span class="pre">miic3.correlate.stats.CorrStats</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">width</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">float</span></span></em><span class="sig-paren">)</span> &#x2192; <span class="pre">numpy.ndarray</span><a class="reference internal" href="../../_modules/miic3/monitor/post_corr_process.html#corr_mat_taper"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#miic3.monitor.post_corr_process.corr_mat_taper" title="Permalink to this definition">¶</a></dt>
<dd><p>Taper a correlation matrix.</p>
<p>Apply a taper to all traces in the correlation matrix.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>np.ndarray</em>) – correlation matrix`</p></li>
<li><p><strong>width</strong> (<em>float</em>) – width to be tapered in seconds (per side)</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>np.ndarray</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The tapered matrix</p>
</dd>
</dl>
<p>..note:: <strong>In-place operation</strong></p>
</dd></dl>

<dl class="py function">
<dt id="miic3.monitor.post_corr_process.corr_mat_taper_center">
<code class="sig-prename descclassname"><span class="pre">miic3.monitor.post_corr_process.</span></code><code class="sig-name descname"><span class="pre">corr_mat_taper_center</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stats</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="../correlate/API.html#miic3.correlate.stats.CorrStats" title="miic3.correlate.stats.CorrStats"><span class="pre">miic3.correlate.stats.CorrStats</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">width</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">slope_frac</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">float</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">0.05</span></span></em><span class="sig-paren">)</span> &#x2192; <span class="pre">numpy.ndarray</span><a class="reference internal" href="../../_modules/miic3/monitor/post_corr_process.html#corr_mat_taper_center"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#miic3.monitor.post_corr_process.corr_mat_taper_center" title="Permalink to this definition">¶</a></dt>
<dd><p>Taper the central part of a correlation matrix.</p>
<p>Due to electromagnetic cross-talk, signal processing or other effects the
correlaton matrices are often contaminated around the zero lag time. This
function tapers (multiples by zero) the central part of width <cite>width</cite>. To
avoid problems with interpolation and filtering later on this is done with
cosine taper</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>np.ndarray</em>) – Correlation data from CorrBulk object</p></li>
<li><p><strong>stats</strong> (<a class="reference internal" href="../correlate/API.html#miic3.correlate.stats.CorrStats" title="miic3.correlate.stats.CorrStats"><em>CorrStats</em></a>) – Stats object from CorrBulk</p></li>
<li><p><strong>width</strong> (<em>float</em>) – width of the central window to be tapered in seconds
(in total, i.e. not per taper side)</p></li>
<li><p><strong>slope_frac</strong> (<em>float</em><em>, </em><em>optional</em>) – fraction of <cite>width</cite> used for soothing of edges,
defaults to 0.05</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The tapered matrix</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="miic3.monitor.post_corr_process.corr_mat_resample_time">
<code class="sig-prename descclassname"><span class="pre">miic3.monitor.post_corr_process.</span></code><code class="sig-name descname"><span class="pre">corr_mat_resample_time</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stats</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="../correlate/API.html#miic3.correlate.stats.CorrStats" title="miic3.correlate.stats.CorrStats"><span class="pre">miic3.correlate.stats.CorrStats</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">freq</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">float</span></span></em><span class="sig-paren">)</span> &#x2192; <span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">,</span> </span><a class="reference internal" href="../correlate/API.html#miic3.correlate.stats.CorrStats" title="miic3.correlate.stats.CorrStats"><span class="pre">miic3.correlate.stats.CorrStats</span></a><span class="p"><span class="pre">]</span></span><a class="reference internal" href="../../_modules/miic3/monitor/post_corr_process.html#corr_mat_resample_time"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#miic3.monitor.post_corr_process.corr_mat_resample_time" title="Permalink to this definition">¶</a></dt>
<dd><p>Resample the lapse time axis of a correlation matrix. The correlations are
automatically filtered with a highpass filter of 0.4*sampling frequency to
avoid aliasing.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>np.ndarray</em>) – correlation matrix</p></li>
<li><p><strong>stats</strong> (<a class="reference internal" href="../correlate/API.html#miic3.correlate.stats.CorrStats" title="miic3.correlate.stats.CorrStats"><code class="xref py py-class docutils literal notranslate"><span class="pre">CorrStats</span></code></a>) – The stats object associated to the
<code class="xref py py-class docutils literal notranslate"><span class="pre">CorrBulk</span></code> object.</p></li>
<li><p><strong>freq</strong> (<em>float</em>) – new sampling frequency</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>Tuple[np.ndarray, <a class="reference internal" href="../correlate/API.html#miic3.correlate.stats.CorrStats" title="miic3.correlate.stats.CorrStats">CorrStats</a>]</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Resampled data and changed stats object.</p>
</dd>
</dl>
<p>..note:: This action is performed <strong>in-place</strong>.</p>
</dd></dl>

<dl class="py function">
<dt id="miic3.monitor.post_corr_process.corr_mat_decimate">
<code class="sig-prename descclassname"><span class="pre">miic3.monitor.post_corr_process.</span></code><code class="sig-name descname"><span class="pre">corr_mat_decimate</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stats</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="../correlate/API.html#miic3.correlate.stats.CorrStats" title="miic3.correlate.stats.CorrStats"><span class="pre">miic3.correlate.stats.CorrStats</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">factor</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> &#x2192; <span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">,</span> </span><a class="reference internal" href="../correlate/API.html#miic3.correlate.stats.CorrStats" title="miic3.correlate.stats.CorrStats"><span class="pre">miic3.correlate.stats.CorrStats</span></a><span class="p"><span class="pre">]</span></span><a class="reference internal" href="../../_modules/miic3/monitor/post_corr_process.html#corr_mat_decimate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#miic3.monitor.post_corr_process.corr_mat_decimate" title="Permalink to this definition">¶</a></dt>
<dd><p>Downsample a correlation matrix by an integer sample. A low-pass filter
is applied before decimating.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>np.ndarray</em>) – correlation matrix</p></li>
<li><p><strong>stats</strong> (<a class="reference internal" href="../correlate/API.html#miic3.correlate.stats.CorrStats" title="miic3.correlate.stats.CorrStats"><code class="xref py py-class docutils literal notranslate"><span class="pre">CorrStats</span></code></a>) – The stats object associated to the
<code class="xref py py-class docutils literal notranslate"><span class="pre">CorrBulk</span></code> object.</p></li>
<li><p><strong>factor</strong> (<em>int</em>) – The factor to reduce the sampling frequency by</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>Tuple[np.ndarray, <a class="reference internal" href="../correlate/API.html#miic3.correlate.stats.CorrStats" title="miic3.correlate.stats.CorrStats">CorrStats</a>]</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Decimated data and changed stats object.</p>
</dd>
</dl>
<p>..note:: This action is performed <strong>in-place</strong>.</p>
</dd></dl>

<dl class="py function">
<dt id="miic3.monitor.post_corr_process.corr_mat_resample_or_decimate">
<code class="sig-prename descclassname"><span class="pre">miic3.monitor.post_corr_process.</span></code><code class="sig-name descname"><span class="pre">corr_mat_resample_or_decimate</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stats</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="../correlate/API.html#miic3.correlate.stats.CorrStats" title="miic3.correlate.stats.CorrStats"><span class="pre">miic3.correlate.stats.CorrStats</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">freq</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">float</span></span></em><span class="sig-paren">)</span> &#x2192; <span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">,</span> </span><a class="reference internal" href="../correlate/API.html#miic3.correlate.stats.CorrStats" title="miic3.correlate.stats.CorrStats"><span class="pre">miic3.correlate.stats.CorrStats</span></a><span class="p"><span class="pre">]</span></span><a class="reference internal" href="../../_modules/miic3/monitor/post_corr_process.html#corr_mat_resample_or_decimate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#miic3.monitor.post_corr_process.corr_mat_resample_or_decimate" title="Permalink to this definition">¶</a></dt>
<dd><p>Downsample a correlation matrix. Decides automatically whether to decimate
or downsampled depneding on the target frequency. A low-pass filter
is applied to avoid aliasing.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>np.ndarray</em>) – correlation matrix</p></li>
<li><p><strong>stats</strong> (<a class="reference internal" href="../correlate/API.html#miic3.correlate.stats.CorrStats" title="miic3.correlate.stats.CorrStats"><code class="xref py py-class docutils literal notranslate"><span class="pre">CorrStats</span></code></a>) – The stats object associated to the
<code class="xref py py-class docutils literal notranslate"><span class="pre">CorrBulk</span></code> object.</p></li>
<li><p><strong>freq</strong> (<em>float</em>) – new sampling frequency</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>Tuple[np.ndarray, <a class="reference internal" href="../correlate/API.html#miic3.correlate.stats.CorrStats" title="miic3.correlate.stats.CorrStats">CorrStats</a>]</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Decimated data and changed stats object.</p>
</dd>
</dl>
<p>..note:: This action is performed <strong>in-place</strong>.</p>
</dd></dl>

<dl class="py function">
<dt id="miic3.monitor.post_corr_process.corr_mat_extract_trace">
<code class="sig-prename descclassname"><span class="pre">miic3.monitor.post_corr_process.</span></code><code class="sig-name descname"><span class="pre">corr_mat_extract_trace</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stats</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="../correlate/API.html#miic3.correlate.stats.CorrStats" title="miic3.correlate.stats.CorrStats"><span class="pre">miic3.correlate.stats.CorrStats</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">'mean'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">percentile</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">float</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">50.0</span></span></em><span class="sig-paren">)</span> &#x2192; <span class="pre">numpy.ndarray</span><a class="reference internal" href="../../_modules/miic3/monitor/post_corr_process.html#corr_mat_extract_trace"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#miic3.monitor.post_corr_process.corr_mat_extract_trace" title="Permalink to this definition">¶</a></dt>
<dd><p>Extract a representative trace from a correlation matrix.</p>
<p>Extract a correlation trace from the that best represents the correlation
matrix. <code class="docutils literal notranslate"><span class="pre">Method</span></code> decides about method to extract the trace. The following
possibilities are available</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">mean</span></code> averages all traces in the matrix</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">norm_mean</span></code> averages the traces normalized after normalizing for maxima</p></li>
<li><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">similarity_percentile</span></code> averages the <code class="docutils literal notranslate"><span class="pre">percentile</span></code> % of traces that</dt><dd><p>best correlate with the mean of all traces. This will exclude abnormal
traces. <code class="docutils literal notranslate"><span class="pre">percentile</span></code> = 50 will return an average of traces with
correlation (with mean trace) above the median.</p>
</dd>
</dl>
</li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>corr_mat</strong> (<em>dictionary</em>) – correlation matrix dictionary</p></li>
<li><p><strong>method</strong> (<em>string</em>) – method to extract the trace</p></li>
<li><p><strong>percentile</strong> (<em>float</em>) – only used for method==’similarity_percentile’</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>trace dictionary of type correlation trace</p>
</dd>
<dt class="field-odd">Return trace<strong>trace</strong></dt>
<dd class="field-odd"><p>extracted trace</p>
</dd>
</dl>
</dd></dl>

<dl class="py exception">
<dt id="miic3.monitor.post_corr_process.Error">
<em class="property"><span class="pre">exception</span> </em><code class="sig-prename descclassname"><span class="pre">miic3.monitor.post_corr_process.</span></code><code class="sig-name descname"><span class="pre">Error</span></code><a class="reference internal" href="../../_modules/miic3/monitor/post_corr_process.html#Error"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#miic3.monitor.post_corr_process.Error" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Exception</span></code></p>
</dd></dl>

<dl class="py exception">
<dt id="miic3.monitor.post_corr_process.InputError">
<em class="property"><span class="pre">exception</span> </em><code class="sig-prename descclassname"><span class="pre">miic3.monitor.post_corr_process.</span></code><code class="sig-name descname"><span class="pre">InputError</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">msg</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/miic3/monitor/post_corr_process.html#InputError"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#miic3.monitor.post_corr_process.InputError" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#miic3.monitor.post_corr_process.Error" title="miic3.monitor.post_corr_process.Error"><code class="xref py py-class docutils literal notranslate"><span class="pre">miic3.monitor.post_corr_process.Error</span></code></a></p>
</dd></dl>

<dl class="py function">
<dt id="miic3.monitor.post_corr_process.corr_mat_rotate">
<code class="sig-prename descclassname"><span class="pre">miic3.monitor.post_corr_process.</span></code><code class="sig-name descname"><span class="pre">corr_mat_rotate</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">corr_mat_list</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/miic3/monitor/post_corr_process.html#corr_mat_rotate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#miic3.monitor.post_corr_process.corr_mat_rotate" title="Permalink to this definition">¶</a></dt>
<dd><p>Rotate correlation matrices from the NEZ in the RTZ frame. Corr_mat_list
contains the NN,NE,NZ,EN,EE,EZ,ZN,ZE,ZZ components of the Greens tensor. Time
vectors of all the correlation matricies must be identical.</p>
</dd></dl>

<dl class="py function">
<dt id="miic3.monitor.post_corr_process.corr_mat_rotate_horiz">
<code class="sig-prename descclassname"><span class="pre">miic3.monitor.post_corr_process.</span></code><code class="sig-name descname"><span class="pre">corr_mat_rotate_horiz</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">corr_mat_list</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/miic3/monitor/post_corr_process.html#corr_mat_rotate_horiz"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#miic3.monitor.post_corr_process.corr_mat_rotate_horiz" title="Permalink to this definition">¶</a></dt>
<dd><p>Rotate correlation matrices from the NE into the RT frame. Corr_mat_list
contains the NN,NE,EN,EE components of the Greens tensor. Time
vectors of all the correlation matricies must be identical.</p>
</dd></dl>

<dl class="py function">
<dt id="miic3.monitor.post_corr_process.corr_mat_stretch">
<code class="sig-prename descclassname"><span class="pre">miic3.monitor.post_corr_process.</span></code><code class="sig-name descname"><span class="pre">corr_mat_stretch</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cdata</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stats</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="../correlate/API.html#miic3.correlate.stats.CorrStats" title="miic3.correlate.stats.CorrStats"><span class="pre">miic3.correlate.stats.CorrStats</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">ref_trc</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tw</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stretch_range</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">float</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stretch_steps</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sides</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">'both'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_sim_mat</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">bool</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> &#x2192; <span class="pre">dict</span><a class="reference internal" href="../../_modules/miic3/monitor/post_corr_process.html#corr_mat_stretch"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#miic3.monitor.post_corr_process.corr_mat_stretch" title="Permalink to this definition">¶</a></dt>
<dd><p>Time stretch estimate through stretch and comparison.</p>
<p>This function estimates stretching of the time axis of traces as it can
occur if the propagation velocity changes.</p>
<p>Time stretching is estimated comparing each correlation function stored
in the <code class="docutils literal notranslate"><span class="pre">corr_data</span></code> matrix (one for each row) with <code class="docutils literal notranslate"><span class="pre">stretch_steps</span></code>
stretched versions  of reference trace stored in <code class="docutils literal notranslate"><span class="pre">ref_trc</span></code>. If
<code class="docutils literal notranslate"><span class="pre">ref_trc</span></code> is <code class="docutils literal notranslate"><span class="pre">None</span></code> the mean of all traces is used.
The maximum amount of stretching may be passed in <code class="docutils literal notranslate"><span class="pre">stretch_range</span></code>. The
time axis is multiplied by exp(stretch).
The best match (stretching amount and corresponding correlation value) is
calculated on different time windows. If <code class="docutils literal notranslate"><span class="pre">tw</span> <span class="pre">=</span> <span class="pre">None</span></code> the stretching is
estimated on the whole trace.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>corr_mat</strong> (<em>dictionary</em>) – correlation matrix dictionary as produced by
<code class="xref py py-class docutils literal notranslate"><span class="pre">recombine_corr_data</span></code></p></li>
<li><p><strong>ref_trc</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>) – 1D array containing the reference trace to be stretched
and compared to the individual traces in <code class="docutils literal notranslate"><span class="pre">mat</span></code></p></li>
<li><p><strong>tw</strong> (list of <code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code> of int) – list of 1D ndarrays holding the indices of samples in the time
windows to be use in the time shift estimate. The samples are counted
from the zero lag time with the index of the first sample being 0. If
<code class="docutils literal notranslate"><span class="pre">tw</span> <span class="pre">=</span> <span class="pre">None</span></code> the full time range is used.</p></li>
<li><p><strong>stretch_range</strong> (<em>scalar</em>) – Maximum amount of relative stretching.
Stretching and compression is tested from <code class="docutils literal notranslate"><span class="pre">-stretch_range</span></code> to
<code class="docutils literal notranslate"><span class="pre">stretch_range</span></code>.</p></li>
<li><p><strong>stretch_steps</strong> (<em>scalar`</em>) – Number of shifted version to be tested. The
increment will be <code class="docutils literal notranslate"><span class="pre">(2</span> <span class="pre">*</span> <span class="pre">stretch_range)</span> <span class="pre">/</span> <span class="pre">stretch_steps</span></code></p></li>
<li><p><strong>sides</strong> (<em>str</em>) – Side of the reference matrix to be used for the stretching
estimate (‘both’ | ‘left’ | ‘right’ | ‘single’) <code class="docutils literal notranslate"><span class="pre">single</span></code> is used for
one-sided signals from active sources with zero lag time is on the
first sample. Other options assume that the zero lag time is in the
center of the traces.</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>Dictionary</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><p><strong>dv</strong>: Dictionary with the following keys</p>
<dl class="simple">
<dt><em>corr</em>: 2d ndarray containing the correlation value for the best</dt><dd><p>match for each row of <code class="docutils literal notranslate"><span class="pre">mat</span></code> and for each time window.
Its dimension is: :func:(len(tw),mat.shape[1])</p>
</dd>
<dt><em>value</em>: 2d ndarray containing the stretch amount corresponding to</dt><dd><p>the best match for each row of <code class="docutils literal notranslate"><span class="pre">mat</span></code> and for each time window.
Stretch is a relative value corresponding to the negative relative
velocity change -dv/v.
Its dimension is: :func:(len(tw),mat.shape[1])</p>
</dd>
<dt><em>sim_mat</em>: 3d ndarray containing the similarity matricies that</dt><dd><p>indicate the correlation coefficient with the reference for the
different time windows, different times and different amount of
stretching.
Its dimension is: <code class="xref py py-func docutils literal notranslate"><span class="pre">(len(tw),mat.shape[1],len(strvec))()</span></code></p>
</dd>
<dt><em>second_axis</em>: It contains the stretch vector used for the velocity</dt><dd><p>change estimate.</p>
</dd>
<dt><em>vale_type</em>: It is equal to ‘stretch’ and specify the content of</dt><dd><p>the returned ‘value’.</p>
</dd>
<dt><em>method</em>: It is equal to ‘single_ref’ and specify in which “way” the</dt><dd><p>values have been obtained.</p>
</dd>
</dl>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="miic3.monitor.post_corr_process.corr_mat_correct_stretch">
<code class="sig-prename descclassname"><span class="pre">miic3.monitor.post_corr_process.</span></code><code class="sig-name descname"><span class="pre">corr_mat_correct_stretch</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">corr_mat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dv</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/miic3/monitor/post_corr_process.html#corr_mat_correct_stretch"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#miic3.monitor.post_corr_process.corr_mat_correct_stretch" title="Permalink to this definition">¶</a></dt>
<dd><p>Correct stretching of correlation matrix</p>
<p>In the case of a homogeneous subsurface velocity change the correlation
traces are stretched or compressed. This stretching can be measured
with <cite>corr_mat_stretch</cite>. The resulting <cite>dv</cite> dictionary can be passed to
this function to remove the stretching from the correlation matrix.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>corr_mat</strong> (<em>dictionary</em>) – correlation matrix dictionary as produced by
<code class="xref py py-class docutils literal notranslate"><span class="pre">recombine_corr_data</span></code></p></li>
<li><p><strong>dv</strong> (<em>Dictionary</em>) – velocity change dictionary</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>Dictionary</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>corrected correlation matrix dictionary</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="miic3.monitor.post_corr_process.corr_mat_shift">
<code class="sig-prename descclassname"><span class="pre">miic3.monitor.post_corr_process.</span></code><code class="sig-name descname"><span class="pre">corr_mat_shift</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stats</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="../correlate/API.html#miic3.correlate.stats.CorrStats" title="miic3.correlate.stats.CorrStats"><span class="pre">miic3.correlate.stats.CorrStats</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">ref_trc</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tw</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shift_range</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">float</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shift_steps</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sides</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">'both'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_sim_mat</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">bool</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> &#x2192; <span class="pre">dict</span><a class="reference internal" href="../../_modules/miic3/monitor/post_corr_process.html#corr_mat_shift"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#miic3.monitor.post_corr_process.corr_mat_shift" title="Permalink to this definition">¶</a></dt>
<dd><p>Time shift estimate through shifting and comparison.</p>
<p>This function estimates shifting of the time axis of traces as it can
occur if the clocks of digitizers drift.</p>
<p>Time shifts are estimated comparing each correlation function stored
in the <code class="docutils literal notranslate"><span class="pre">corr_data</span></code> matrix (one for each row) with <code class="docutils literal notranslate"><span class="pre">shift_steps</span></code>
shifted versions  of reference trace stored in <code class="docutils literal notranslate"><span class="pre">ref_trc</span></code>.
The maximum amount of shifting may be passed in <code class="docutils literal notranslate"><span class="pre">shift_range</span></code>.
The best match (shifting amount and corresponding correlation value) is
calculated on different time windows. If <code class="docutils literal notranslate"><span class="pre">tw</span> <span class="pre">=</span> <span class="pre">None</span></code> the shifting is
estimated on the whole trace.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>corr_mat</strong> (<em>dictionary</em>) – correlation matrix dictionary as produced by
<code class="xref py py-class docutils literal notranslate"><span class="pre">recombine_corr_data</span></code></p></li>
<li><p><strong>ref_trc</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>) – 1D array containing the reference trace to be stretched
and compared to the individual traces in <code class="docutils literal notranslate"><span class="pre">mat</span></code></p></li>
<li><p><strong>tw</strong> (list of <code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code> of int) – list of 1D ndarrays holding the indices of sampels in the time
windows to be use in the time shift estimate. The sampels are counted
from the zero lag time with the index of the first sample being 0. If
<code class="docutils literal notranslate"><span class="pre">tw</span> <span class="pre">=</span> <span class="pre">None</span></code> the full time range is used.</p></li>
<li><p><strong>shift_range</strong> (<em>scalar</em>) – Maximum amount of shifting in samples.
Shifting is tested from <code class="docutils literal notranslate"><span class="pre">-stretch_range</span></code> to
<code class="docutils literal notranslate"><span class="pre">stretch_range</span></code>.</p></li>
<li><p><strong>shift_steps</strong> (<em>scalar`</em>) – Number of shifted version to be tested. The
increment will be <code class="docutils literal notranslate"><span class="pre">(2</span> <span class="pre">*</span> <span class="pre">shift_range)</span> <span class="pre">/</span> <span class="pre">shift_steps</span></code></p></li>
<li><p><strong>sides</strong> (<em>str</em>) – Side of the reference matrix to be used for the shifting
estimate (‘both’ | ‘right’) <code class="docutils literal notranslate"><span class="pre">single</span></code> is used for
one-sided signals from active sources with zero lag time is on the
first sample. Other options assume that the zero lag time is in the
center of the traces.</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>Dictionary</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><p><strong>dv</strong>: Dictionary with the following keys</p>
<dl class="simple">
<dt><em>corr</em>: 2d ndarray containing the correlation value for the best</dt><dd><p>match for each row of <code class="docutils literal notranslate"><span class="pre">mat</span></code> and for each time window.
Its dimension is: :func:(len(tw),mat.shape[1])</p>
</dd>
<dt><em>value</em>: 2d ndarray containing the stretch amount corresponding to</dt><dd><p>the best match for each row of <code class="docutils literal notranslate"><span class="pre">mat</span></code> and for each time window.
Stretch is a relative value corresponding to the negative relative
velocity change -dv/v.
Its dimension is: :func:(len(tw),mat.shape[1])</p>
</dd>
<dt><em>sim_mat</em>: 3d ndarray containing the similarity matricies that</dt><dd><p>indicate the correlation coefficient with the reference for the
different time windows, different times and different amount of
stretching.
Its dimension is: <code class="xref py py-func docutils literal notranslate"><span class="pre">(len(tw),mat.shape[1],len(strvec))()</span></code></p>
</dd>
<dt><em>second_axis</em>: It contains the stretch vector used for the velocity</dt><dd><p>change estimate.</p>
</dd>
<dt><em>vale_type</em>: It is equal to ‘shift’ and specify the content of</dt><dd><p>the returned ‘value’.</p>
</dd>
<dt><em>method</em>: It is equal to ‘single_ref’ and specify in which “way” the</dt><dd><p>values have been obtained.</p>
</dd>
</dl>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="miic3.monitor.post_corr_process.corr_mat_correct_shift">
<code class="sig-prename descclassname"><span class="pre">miic3.monitor.post_corr_process.</span></code><code class="sig-name descname"><span class="pre">corr_mat_correct_shift</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">corr_mat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dt</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/miic3/monitor/post_corr_process.html#corr_mat_correct_shift"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#miic3.monitor.post_corr_process.corr_mat_correct_shift" title="Permalink to this definition">¶</a></dt>
<dd><p>Correct shift of a correlation matrix</p>
<p>In the case of a clock error the correlation traces are shifted in lag time
This shifting can be measured with <cite>corr_mat_shift</cite>. The resulting <cite>dt</cite>
dictionary can be passed to this function to remove the shifhting from the
correlation matrix.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>corr_mat</strong> (<em>dictionary</em>) – correlation matrix dictionary as produced by
<code class="xref py py-class docutils literal notranslate"><span class="pre">recombine_corr_data</span></code></p></li>
<li><p><strong>dt</strong> (<em>Dictionary</em>) – velocity change dictionary</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>Dictionary</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>corrected correlation matrix dictionary</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="miic3-monitor-stretch-mod">
<h2>miic3.monitor.stretch_mod<a class="headerlink" href="#miic3-monitor-stretch-mod" title="Permalink to this headline">¶</a></h2>
<p>Holds functions for the velocity estimation via stretching.</p>
<span class="target" id="module-miic3.monitor.stretch_mod"></span><dl class="field-list simple">
<dt class="field-odd">copyright</dt>
<dd class="field-odd"><p></p></dd>
<dt class="field-even">license</dt>
<dd class="field-even"><p>GNU Lesser General Public License, Version 3
(<a class="reference external" href="https://www.gnu.org/copyleft/lesser.html">https://www.gnu.org/copyleft/lesser.html</a>)</p>
</dd>
<dt class="field-odd">author</dt>
<dd class="field-odd"><p>Peter Makus (<a class="reference external" href="mailto:makus&#37;&#52;&#48;gfz-potsdam&#46;de">makus<span>&#64;</span>gfz-potsdam<span>&#46;</span>de</a>)</p>
</dd>
</dl>
<p>Created: Tuesday, 15th June 2021 03:42:14 pm
Last Modified: Tuesday, 20th July 2021 04:27:22 pm</p>
<dl class="py function">
<dt id="miic3.monitor.stretch_mod.time_windows_creation">
<code class="sig-prename descclassname"><span class="pre">miic3.monitor.stretch_mod.</span></code><code class="sig-name descname"><span class="pre">time_windows_creation</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">starting_list</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t_width</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> &#x2192; <span class="pre">numpy.ndarray</span><a class="reference internal" href="../../_modules/miic3/monitor/stretch_mod.html#time_windows_creation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#miic3.monitor.stretch_mod.time_windows_creation" title="Permalink to this definition">¶</a></dt>
<dd><p>Time windows creation.</p>
<p>A matrix containing one time window for each row is created. The starting
samples of each one of them are passed in the <code class="docutils literal notranslate"><span class="pre">starting_list</span></code> parameter.
The windows length <code class="docutils literal notranslate"><span class="pre">t_width</span></code> can be scalar or a list of values.
In the latter case both lists <code class="docutils literal notranslate"><span class="pre">starting_list</span></code> and <code class="docutils literal notranslate"><span class="pre">t_width</span></code> must
have the same length.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>starting_list</strong> (<em>list</em>) – List of starting points</p></li>
<li><p><strong>t_width</strong> (<em>int</em><em> or </em><em>list of int</em>) – Windows length</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><strong>tw_mat</strong>: 2d ndarray containing the indexes of one time window
for each row</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="miic3.monitor.stretch_mod.velocity_change_estimate">
<code class="sig-prename descclassname"><span class="pre">miic3.monitor.stretch_mod.</span></code><code class="sig-name descname"><span class="pre">velocity_change_estimate</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mat</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tw</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">strrefmat</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">strvec</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sides</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">'both'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_sim_mat</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">bool</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">remove_nans</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">bool</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span> &#x2192; <span class="pre">dict</span><a class="reference internal" href="../../_modules/miic3/monitor/stretch_mod.html#velocity_change_estimate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#miic3.monitor.stretch_mod.velocity_change_estimate" title="Permalink to this definition">¶</a></dt>
<dd><p>Velocity change estimate through stretching and comparison.</p>
<p>Velocity changes are estimated comparing each correlation function stored
in the <code class="docutils literal notranslate"><span class="pre">mat</span></code> matrix (one for each row) with <code class="docutils literal notranslate"><span class="pre">strrefmat.shape[0]</span></code>
stretched versions  of a reference trace stored in <code class="docutils literal notranslate"><span class="pre">strrefmat</span></code>.
The stretch amount for each row of <code class="docutils literal notranslate"><span class="pre">strrefmat</span></code> must be passed in the
<code class="docutils literal notranslate"><span class="pre">strvec</span></code> vector.
The best match (stretch amount and corresponding correlation value) is
calculated on different time windows (each row of <code class="docutils literal notranslate"><span class="pre">tw</span></code> is a different
one) instead of on the whole trace.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mat</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>) – 2d ndarray containing the correlation functions.
One for each row.</p></li>
<li><p><strong>tw</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code> of int) – 2d ndarray of time windows to be use in the velocity change
estimate.</p></li>
<li><p><strong>strrefmat</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>) – 2D array containing stretched version of the reference
matrix</p></li>
<li><p><strong>strvec</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code> or list) – Stretch amount for each row of <code class="docutils literal notranslate"><span class="pre">strrefmat</span></code></p></li>
<li><p><strong>sides</strong> (<em>string</em>) – Side of the reference matrix to be used for the velocity
change estimate (‘both’ | ‘left’ | ‘right’ | ‘single’)</p></li>
<li><p><strong>remove_nans</strong> (<em>bool</em>) – If <cite>True</cite> applay <code class="xref py py-func docutils literal notranslate"><span class="pre">nan_to_num()</span></code> to the
given correlation matrix before any other operation.</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>Dictionary</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><p><strong>dv</strong>: Dictionary with the following keys</p>
<dl class="simple">
<dt><em>corr</em>: 2d ndarray containing the correlation value for the best</dt><dd><p>match for each row of <code class="docutils literal notranslate"><span class="pre">mat</span></code> and for each time window.
Its dimension is: :func:(len(tw),mat.shape[1])</p>
</dd>
<dt><em>value</em>: 2d ndarray containing the stretch amount corresponding to</dt><dd><p>the best match for each row of <code class="docutils literal notranslate"><span class="pre">mat</span></code> and for each time window.
Its dimension is: :func:(len(tw),mat.shape[1])</p>
</dd>
<dt><em>sim_mat</em>: 3d ndarray containing the similarity matricies that</dt><dd><p>indicate the correlation coefficient with the reference for the
different time windows, different times and different amount of
stretching.
Its dimension is: <code class="xref py py-func docutils literal notranslate"><span class="pre">(len(tw),mat.shape[1],len(strvec))()</span></code></p>
</dd>
<dt><em>second_axis</em>: It contains the stretch vector used for the velocity</dt><dd><p>change estimate.</p>
</dd>
<dt><em>vale_type</em>: It is equal to ‘stretch’ and specify the content of</dt><dd><p>the returned ‘value’.</p>
</dd>
<dt><em>method</em>: It is equal to ‘single_ref’ and specify in which “way” the</dt><dd><p>values have been obtained.</p>
</dd>
</dl>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="miic3.monitor.stretch_mod.time_stretch_estimate">
<code class="sig-prename descclassname"><span class="pre">miic3.monitor.stretch_mod.</span></code><code class="sig-name descname"><span class="pre">time_stretch_estimate</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">corr_data</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ref_trc</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tw</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stretch_range</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">float</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stretch_steps</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sides</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">'both'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">remove_nans</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">bool</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span> &#x2192; <span class="pre">dict</span><a class="reference internal" href="../../_modules/miic3/monitor/stretch_mod.html#time_stretch_estimate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#miic3.monitor.stretch_mod.time_stretch_estimate" title="Permalink to this definition">¶</a></dt>
<dd><p>Time stretch estimate through stretch and comparison.</p>
<p>This function estimates stretching of the time axis of traces as it can
occur if the propagation velocity changes.</p>
<p>Time stretching is estimated comparing each correlation function stored
in the <code class="docutils literal notranslate"><span class="pre">corr_data</span></code> matrix (one for each row) with <code class="docutils literal notranslate"><span class="pre">stretch_steps</span></code>
stretched versions  of reference trace stored in <code class="docutils literal notranslate"><span class="pre">ref_trc</span></code>.
The maximum amount of stretching may be passed in <code class="docutils literal notranslate"><span class="pre">stretch_range</span></code>. The
time axis is multiplied by exp(stretch).
The best match (stretching amount and corresponding correlation value) is
calculated on different time windows. If <code class="docutils literal notranslate"><span class="pre">tw</span> <span class="pre">=</span> <span class="pre">None</span></code> the stretching is
estimated on the whole trace.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>corr_data</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>) – 2d ndarray containing the correlation functions.
One for each row.</p></li>
<li><p><strong>ref_trc</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>) – 1D array containing the reference trace to be shifted and
compared to the individual traces in <code class="docutils literal notranslate"><span class="pre">mat</span></code></p></li>
<li><p><strong>tw</strong> (list of <code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code> of int) – list of 1D ndarrays holding the indices of sampels in the time
windows to be use in the time shift estimate. The sampels are counted
from the zero lag time with the index of the first sample being 0. If
<code class="docutils literal notranslate"><span class="pre">tw</span> <span class="pre">=</span> <span class="pre">None</span></code> the full time range is used.</p></li>
<li><p><strong>stretch_range</strong> (<em>scalar</em>) – Maximum amount of relative stretching.
Stretching and compression is tested from <code class="docutils literal notranslate"><span class="pre">-stretch_range</span></code> to
<code class="docutils literal notranslate"><span class="pre">stretch_range</span></code>.</p></li>
<li><p><strong>stretch_steps</strong> (<em>scalar`</em>) – Number of shifted version to be tested. The
increment will be <code class="docutils literal notranslate"><span class="pre">(2</span> <span class="pre">*</span> <span class="pre">stretch_range)</span> <span class="pre">/</span> <span class="pre">stretch_steps</span></code></p></li>
<li><p><strong>sides</strong> (<em>str</em>) – Side of the reference matrix to be used for the stretching
estimate (‘both’ | ‘left’ | ‘right’ | ‘single’) <code class="docutils literal notranslate"><span class="pre">single</span></code> is used for
one-sided signals from active sources with zero lag time is on the
first sample. Other options assume that the zero lag time is in the
center of the traces.</p></li>
<li><p><strong>remove_nans</strong> (<em>bool</em>) – If <cite>True</cite> applay <code class="xref py py-func docutils literal notranslate"><span class="pre">nan_to_num()</span></code> to the
given correlation matrix before any other operation.</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>Dictionary</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><p><strong>dv</strong>: Dictionary with the following keys</p>
<dl class="simple">
<dt><em>corr</em>: 2d ndarray containing the correlation value for the best</dt><dd><p>match for each row of <code class="docutils literal notranslate"><span class="pre">mat</span></code> and for each time window.
Its dimension is: :func:(len(tw),mat.shape[1])</p>
</dd>
<dt><em>value</em>: 2d ndarray containing the stretch amount corresponding to</dt><dd><p>the best match for each row of <code class="docutils literal notranslate"><span class="pre">mat</span></code> and for each time window.
Stretch is a relative value corresponding to the negative relative
velocity change -dv/v.
Its dimension is: :func:(len(tw),mat.shape[1])</p>
</dd>
<dt><em>sim_mat</em>: 3d ndarray containing the similarity matricies that</dt><dd><p>indicate the correlation coefficient with the reference for the
different time windows, different times and different amount of
stretching.
Its dimension is: <code class="xref py py-func docutils literal notranslate"><span class="pre">(len(tw),mat.shape[1],len(strvec))()</span></code></p>
</dd>
<dt><em>second_axis</em>: It contains the stretch vector used for the velocity</dt><dd><p>change estimate.</p>
</dd>
<dt><em>vale_type</em>: It is equal to ‘stretch’ and specify the content of</dt><dd><p>the returned ‘value’.</p>
</dd>
<dt><em>method</em>: It is equal to ‘single_ref’ and specify in which “way” the</dt><dd><p>values have been obtained.</p>
</dd>
</dl>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="miic3.monitor.stretch_mod.multi_ref_vchange">
<code class="sig-prename descclassname"><span class="pre">miic3.monitor.stretch_mod.</span></code><code class="sig-name descname"><span class="pre">multi_ref_vchange</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">corr_data</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ref_trs</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tw</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stretch_range</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">float</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stretch_steps</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sides</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">'both'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">remove_nans</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">bool</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span> &#x2192; <span class="pre">dict</span><a class="reference internal" href="../../_modules/miic3/monitor/stretch_mod.html#multi_ref_vchange"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#miic3.monitor.stretch_mod.multi_ref_vchange" title="Permalink to this definition">¶</a></dt>
<dd><p>Velocity change estimate with single or multiple reference traces.</p>
<p>This function estimates the velocity change corresponding to each row of
the <code class="docutils literal notranslate"><span class="pre">corr_data</span></code> matrix respect to the reference trace/s passed in
<code class="docutils literal notranslate"><span class="pre">ref_trs</span></code>.</p>
<p>The velocity change is estimated comparing each correlation function stored
in the <code class="docutils literal notranslate"><span class="pre">corr_data</span></code> matrix (one for each row) with <code class="docutils literal notranslate"><span class="pre">stretch_steps</span></code>
stretched versions of reference/s trace stored in <code class="docutils literal notranslate"><span class="pre">ref_trs</span></code>.
The maximum amount of stretching may be passed in <code class="docutils literal notranslate"><span class="pre">stretch_range</span></code>.
The best match (stretching amount and corresponding correlation value) is
calculated on different time windows. If <code class="docutils literal notranslate"><span class="pre">tw</span> <span class="pre">=</span> <span class="pre">None</span></code> the stretching is
estimated on the whole trace.</p>
<p>The output is a dictionary with keys of the form <code class="docutils literal notranslate"><span class="pre">&quot;reftr_%d&quot;</span> <span class="pre">%</span> <span class="pre">i</span></code>: One
for each reference trace. The corresponding <code class="docutils literal notranslate"><span class="pre">value</span></code> is aslo a dictionary
that has a structure conforming with
<code class="xref py py-class docutils literal notranslate"><span class="pre">time_stretch_estimate</span></code> output.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>corr_data</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>) – 2d ndarray containing the correlation functions.
One for each row.</p></li>
<li><p><strong>ref_trc</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>) – 1D array containing the reference trace to be shifted and
compared to the individual traces in <code class="docutils literal notranslate"><span class="pre">mat</span></code></p></li>
<li><p><strong>tw</strong> (list of <code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code> of int) – list of 1D ndarrays holding the indices of sampels in the time
windows to be use in the time shift estimate. The sampels are counted
from the zero lag time with the index of the first sample being 0. If
<code class="docutils literal notranslate"><span class="pre">tw</span> <span class="pre">=</span> <span class="pre">None</span></code> the full time range is used.</p></li>
<li><p><strong>stretch_range</strong> (<em>scalar</em>) – Maximum amount of relative stretching.
Stretching and compression is tested from <code class="docutils literal notranslate"><span class="pre">-stretch_range</span></code> to
<code class="docutils literal notranslate"><span class="pre">stretch_range</span></code>.</p></li>
<li><p><strong>stretch_steps</strong> (<em>scalar`</em>) – Number of shifted version to be tested. The
increment will be <code class="docutils literal notranslate"><span class="pre">(2</span> <span class="pre">*</span> <span class="pre">stretch_range)</span> <span class="pre">/</span> <span class="pre">stretch_steps</span></code></p></li>
<li><p><strong>single_sided</strong> (<em>bool</em>) – if True zero lag time is on the first sample. If
False the zero lag time is in the center of the traces.</p></li>
<li><p><strong>sides</strong> (<em>str</em>) – Side of the reference matrix to be used for the stretching
estimate (‘both’ | ‘left’ | ‘right’ | ‘single’) <code class="docutils literal notranslate"><span class="pre">single</span></code> is used for
one-sided signals from active sources with zero lag time is on the
first sample. Other options assume that the zero lag time is in the
center of the traces.</p></li>
<li><p><strong>remove_nans</strong> (<em>bool</em>) – If <cite>True</cite> applay <code class="xref py py-func docutils literal notranslate"><span class="pre">nan_to_num()</span></code> to the
given correlation matrix before any other operation.</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>dictionary</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><strong>multi_ref_panel</strong>: It is a dictionary that contains as much
dictionaries as reference traces have been used. The key format is
<code class="docutils literal notranslate"><span class="pre">&quot;reftr_%d&quot;</span> <span class="pre">%</span> <span class="pre">i</span></code> and the corresponding value is also a dictionary
with the structure described in
<code class="xref py py-class docutils literal notranslate"><span class="pre">time_stretch_estimate</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="miic3.monitor.stretch_mod.est_shift_from_dt_corr">
<code class="sig-prename descclassname"><span class="pre">miic3.monitor.stretch_mod.</span></code><code class="sig-name descname"><span class="pre">est_shift_from_dt_corr</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dt1</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dt2</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">corr1</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">corr2</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">numpy.ndarray</span></span></em><span class="sig-paren">)</span> &#x2192; <span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">,</span> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><a class="reference internal" href="../../_modules/miic3/monitor/stretch_mod.html#est_shift_from_dt_corr"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#miic3.monitor.stretch_mod.est_shift_from_dt_corr" title="Permalink to this definition">¶</a></dt>
<dd><p>Estimation of a baseline shift between velocity-change measurements
preformed with different references.</p>
<p>The use of different reference traces obtaind from different reference
periods will result in a shift of the velocity-change curves that ideally
characterizes the velocity variation between the two reference periods.
Instead of directly measuring this velocity change from the two reference
traces it is calulated here as the weighted average of the point
differences between the two velocity-change curves weighted by their
inverse variance according to Weaver et al. GJI 2011 (On the precision of
noise correlation interferometry)</p>
<p>Input vertors must all be of the same lenth.</p>
<dl class="field-list simple">
<dt class="field-odd">Pram dt1</dt>
<dd class="field-odd"><p>Velocity variation measured for reference A</p>
</dd>
<dt class="field-even">Pram dt2</dt>
<dd class="field-even"><p>Velocity variation measured for reference B</p>
</dd>
<dt class="field-odd">Pram corr1</dt>
<dd class="field-odd"><p>Correlation between velocity corrected trace and reference A</p>
</dd>
<dt class="field-even">Pram corr2</dt>
<dd class="field-even"><p>Correlation between velocity corrected trace and reference B</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="miic3.monitor.stretch_mod.estimate_reftr_shifts_from_dt_corr">
<code class="sig-prename descclassname"><span class="pre">miic3.monitor.stretch_mod.</span></code><code class="sig-name descname"><span class="pre">estimate_reftr_shifts_from_dt_corr</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">multi_ref_panel</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_sim_mat</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">bool</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> &#x2192; <span class="pre">dict</span><a class="reference internal" href="../../_modules/miic3/monitor/stretch_mod.html#estimate_reftr_shifts_from_dt_corr"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#miic3.monitor.stretch_mod.estimate_reftr_shifts_from_dt_corr" title="Permalink to this definition">¶</a></dt>
<dd><p>Combine velocity-change measurements of the same data performed with
different references to a single curve.</p>
<p>For a set of velocity-change measurements performed with different
references this function estimates the relative offsets between all pairs
of the measurements as a weighted average of their difference with the
function <code class="xref py py-class docutils literal notranslate"><span class="pre">est_shift_from_dt_corr</span></code>.
A least squares solution in computed that combines the pairwise
differences to a consistent set of reference shifts. These shifts should
be similar to the velocity variations measured between the reference
traces. The consistent set of reference shifts is used to correct i.e.
shift the similarity matricies to a common reference. Finally the
corrected similarity matrices are averaged resulting in a single matrix
that is interpreted as before. The position of the crest is the combined
velocity change and the height of the crest is the correlation value.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>multi_ref_panel</strong> (<em>dictionay</em>) – It is a dictionary with one (key,value) pair
for each reference trace. Its structure is described
in <code class="xref py py-class docutils literal notranslate"><span class="pre">multi_ref_vchange</span></code></p></li>
<li><p><strong>return_sim_mat</strong> (<em>bool</em>) – If <cite>True</cite> the returning dictionary contains also the
similarity matrix <a href="#id1"><span class="problematic" id="id2">`</span></a>sim_mat’.</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>Dictionary</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><p><strong>dv</strong>: Dictionary with the following keys</p>
<dl class="simple">
<dt><em>corr</em>: 2d ndarray containing the correlation value for the best</dt><dd><p>match for each row of <code class="docutils literal notranslate"><span class="pre">mat</span></code> and for each time window.
Its dimension is: :func:(len(tw),mat.shape[1])</p>
</dd>
<dt><em>value</em>: 2d ndarray containing the stretch amount corresponding to</dt><dd><p>the best match for each row of <code class="docutils literal notranslate"><span class="pre">mat</span></code> and for each time window.
Stretch is a relative value corresponding to the negative relative
velocity change -dv/v.
Its dimension is: :func:(len(tw),mat.shape[1])</p>
</dd>
<dt><em>sim_mat</em>: 3d ndarray containing the similarity matricies that</dt><dd><p>indicate the correlation coefficient with the reference for the
different time windows, different times and different amount of
stretching.
Its dimension is: <code class="xref py py-func docutils literal notranslate"><span class="pre">(len(tw),mat.shape[1],len(strvec))()</span></code></p>
</dd>
<dt><em>second_axis</em>: It contains the stretch vector used for the velocity</dt><dd><p>change estimate.</p>
</dd>
<dt><em>value_type</em>: It is equal to ‘stretch’ and specify the content of</dt><dd><p>the returned ‘value’.</p>
</dd>
<dt><em>method</em>: It is equal to ‘single_ref’ and specify in which “way” the</dt><dd><p>values have been obtained.</p>
</dd>
</dl>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="miic3.monitor.stretch_mod.multi_ref_vchange_and_align">
<code class="sig-prename descclassname"><span class="pre">miic3.monitor.stretch_mod.</span></code><code class="sig-name descname"><span class="pre">multi_ref_vchange_and_align</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">corr_data</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ref_trs</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tw</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stretch_range</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">float</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stretch_steps</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sides</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">'both'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_sim_mat</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">bool</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">remove_nans</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">bool</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span> &#x2192; <span class="pre">dict</span><a class="reference internal" href="../../_modules/miic3/monitor/stretch_mod.html#multi_ref_vchange_and_align"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#miic3.monitor.stretch_mod.multi_ref_vchange_and_align" title="Permalink to this definition">¶</a></dt>
<dd><p>Multi-reference dv estimate and alignment</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>corr_data</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>) – 2d ndarray containing the correlation functions.
One for each row.</p></li>
<li><p><strong>ref_trc</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>) – 1D array containing the reference trace to be shifted and
compared to the individual traces in <code class="docutils literal notranslate"><span class="pre">mat</span></code></p></li>
<li><p><strong>tw</strong> (list of <code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code> of int) – list of 1D ndarrays holding the indices of sampels in the time
windows to be use in the time shift estimate. The sampels are counted
from the zero lag time with the index of the first sample being 0. If
<code class="docutils literal notranslate"><span class="pre">tw</span> <span class="pre">=</span> <span class="pre">None</span></code> the full time range is used.</p></li>
<li><p><strong>stretch_range</strong> (<em>scalar</em>) – Maximum amount of relative stretching.
Stretching and compression is tested from <code class="docutils literal notranslate"><span class="pre">-stretch_range</span></code> to
<code class="docutils literal notranslate"><span class="pre">stretch_range</span></code>.</p></li>
<li><p><strong>stretch_steps</strong> (<em>scalar`</em>) – Number of shifted version to be tested. The
increment will be <code class="docutils literal notranslate"><span class="pre">(2</span> <span class="pre">*</span> <span class="pre">stretch_range)</span> <span class="pre">/</span> <span class="pre">stretch_steps</span></code></p></li>
<li><p><strong>single_sided</strong> (<em>bool</em>) – if True zero lag time is on the first sample. If
False the zero lag time is in the center of the traces.</p></li>
<li><p><strong>sides</strong> (<em>str</em>) – Side of the reference matrix to be used for the stretching
estimate (‘both’ | ‘left’ | ‘right’ | ‘single’) <code class="docutils literal notranslate"><span class="pre">single</span></code> is used for
one-sided signals from active sources with zero lag time is on the
first sample. Other options assume that the zero lag time is in the
center of the traces.</p></li>
<li><p><strong>return_sim_mat</strong> (<em>bool</em>) – If <cite>True</cite> the returning dictionary contains also the
similarity matrix <a href="#id3"><span class="problematic" id="id4">`</span></a>sim_mat’.</p></li>
<li><p><strong>remove_nans</strong> (<em>bool</em>) – If <cite>True</cite> applay <code class="xref py py-func docutils literal notranslate"><span class="pre">nan_to_num()</span></code> to the
given correlation matrix before any other operation.</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>Dictionary</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><p><strong>dv</strong>: Dictionary with the following keys</p>
<dl class="simple">
<dt><em>corr</em>: 2d ndarray containing the correlation value for the best</dt><dd><p>match for each row of <code class="docutils literal notranslate"><span class="pre">mat</span></code> and for each time window.
Its dimension is: :func:(len(tw),mat.shape[1])</p>
</dd>
<dt><em>value</em>: 2d ndarray containing the stretch amount corresponding to</dt><dd><p>the best match for each row of <code class="docutils literal notranslate"><span class="pre">mat</span></code> and for each time window.
Stretch is a relative value corresponding to the negative relative
velocity change -dv/v.
Its dimension is: :func:(len(tw),mat.shape[1])</p>
</dd>
<dt><em>sim_mat</em>: 3d ndarray containing the similarity matricies that</dt><dd><p>indicate the correlation coefficient with the reference for the
different time windows, different times and different amount of
stretching.
Its dimension is: <code class="xref py py-func docutils literal notranslate"><span class="pre">(len(tw),mat.shape[1],len(strvec))()</span></code></p>
</dd>
<dt><em>second_axis</em>: It contains the stretch vector used for the velocity</dt><dd><p>change estimate.</p>
</dd>
<dt><em>vale_type</em>: It is equal to ‘stretch’ and specify the content of</dt><dd><p>the returned ‘value’.</p>
</dd>
<dt><em>method</em>: It is equal to ‘single_ref’ and specify in which “way” the</dt><dd><p>values have been obtained.</p>
</dd>
</dl>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="miic3.monitor.stretch_mod.time_shift_estimate">
<code class="sig-prename descclassname"><span class="pre">miic3.monitor.stretch_mod.</span></code><code class="sig-name descname"><span class="pre">time_shift_estimate</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">corr_data</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ref_trc</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tw</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shift_range</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">float</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shift_steps</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">single_sided</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">bool</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_sim_mat</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">bool</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">remove_nans</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">bool</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span> &#x2192; <span class="pre">dict</span><a class="reference internal" href="../../_modules/miic3/monitor/stretch_mod.html#time_shift_estimate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#miic3.monitor.stretch_mod.time_shift_estimate" title="Permalink to this definition">¶</a></dt>
<dd><p>Time shift estimate through shifting and comparison.</p>
<p>This function is intended to estimate shift of traces as they can occur
in noise cross-correlation in case of drifting clocks.</p>
<p>Time shifts are estimated comparing each correlation function stored
in the <code class="docutils literal notranslate"><span class="pre">corr_data</span></code> matrix (one for each row) with <code class="docutils literal notranslate"><span class="pre">shift_steps</span></code>
shifted versions  of reference trace stored in <code class="docutils literal notranslate"><span class="pre">ref_trc</span></code>.
The maximum amount of shifting may be passed in <code class="docutils literal notranslate"><span class="pre">shift_range</span></code>.
The best match (shifting amount and corresponding correlation value) is
calculated on different time windows. If <code class="docutils literal notranslate"><span class="pre">tw</span> <span class="pre">=</span> <span class="pre">None</span></code> the shifting is
estimated on the whole trace.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>corr_data</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>) – 2d ndarray containing the correlation functions.
One for each row.</p></li>
<li><p><strong>ref_trc</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>) – 1D array containing the reference trace to be shifted and
compared to the individual traces in <code class="docutils literal notranslate"><span class="pre">mat</span></code></p></li>
<li><p><strong>tw</strong> (list of <code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code> of int) – list of 1D ndarrays holding the indices of sampels in the time
windows to be use in the time shift estimate. The sampels are counted
from the zero lag time with the index of the first sample being 0. If
<code class="docutils literal notranslate"><span class="pre">tw</span> <span class="pre">=</span> <span class="pre">None</span></code> the full time range is used.</p></li>
<li><p><strong>shift_range</strong> (<em>scalar</em>) – Maximum amount of time shift in samples (in one
direction).
Shifting is tested in both directions from <code class="docutils literal notranslate"><span class="pre">-shift_range</span></code> to
<code class="docutils literal notranslate"><span class="pre">shift_range</span></code></p></li>
<li><p><strong>shift_steps</strong> (<em>scalar`</em>) – Number of shifted version to be tested. The increment
will be <code class="docutils literal notranslate"><span class="pre">(2</span> <span class="pre">*</span> <span class="pre">shift_range)</span> <span class="pre">/</span> <span class="pre">shift_steps</span></code></p></li>
<li><p><strong>single_sided</strong> – If <code class="docutils literal notranslate"><span class="pre">True</span></code> the zero lag time of the traces is in the
first sample. If <code class="docutils literal notranslate"><span class="pre">False</span></code> zero lag is assumed to be in the center of
the traces and the shifting is evaluated on the causal and acausal
parts of the traces separately and averaged. This is done to avoid bias
from velocity changes (stretching) in the case of strongly asymmetric
traces.</p></li>
<li><p><strong>remove_nans</strong> (<em>bool</em>) – If <cite>True</cite> applay <code class="xref py py-func docutils literal notranslate"><span class="pre">nan_to_num()</span></code> to the
given correlation matrix before any other operation.</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>Dictionary</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><p><strong>dt</strong>: Dictionary with the following keys</p>
<dl class="simple">
<dt><em>corr</em>: <code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code> 2d ndarray containing the correlation</dt><dd><p>value for the best match for each row of <code class="docutils literal notranslate"><span class="pre">mat</span></code> and for each
time window.
Its dimension is: :func:(len(tw),mat.shape[1])</p>
</dd>
<dt><em>value</em>: <code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code> 2d ndarray containing the amount of</dt><dd><p>shifting corresponding to the best match for each row of <code class="docutils literal notranslate"><span class="pre">mat</span></code>
and for each time window. Shift is measured in units of the
sampling interval.
Its dimension is: <code class="xref py py-func docutils literal notranslate"><span class="pre">(len(tw),mat.shape[1])()</span></code></p>
</dd>
<dt><em>sim_mat</em>: 2d ndarray containing the similarity matrix that</dt><dd><p>indicate the time shift respect to the reference for the
selected time windows, for different times and different amount of
shift.
Its dimension is: <code class="xref py py-func docutils literal notranslate"><span class="pre">(mat.shape[1],shift_steps)()</span></code></p>
</dd>
<dt><em>second_axis</em>: It contains the shift vector used for the velocity</dt><dd><p>change estimate.</p>
</dd>
<dt><em>vale_type</em>: It is equal to ‘shift’ and specify the content of</dt><dd><p>the returned ‘value’.</p>
</dd>
<dt><em>method</em>: It is equal to ‘time_shift’ and specify in which “way” the</dt><dd><p>values have been obtained.</p>
</dd>
</dl>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="miic3.monitor.stretch_mod.time_stretch_apply">
<code class="sig-prename descclassname"><span class="pre">miic3.monitor.stretch_mod.</span></code><code class="sig-name descname"><span class="pre">time_stretch_apply</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">corr_data</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stretch</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">single_sided</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">bool</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> &#x2192; <span class="pre">numpy.ndarray</span><a class="reference internal" href="../../_modules/miic3/monitor/stretch_mod.html#time_stretch_apply"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#miic3.monitor.stretch_mod.time_stretch_apply" title="Permalink to this definition">¶</a></dt>
<dd><p>Apply time axis stretch to traces.</p>
<p>Stretch the time axis of traces e.g. to compensate a velocity shift in the
propagation medium.
Such shifts can occur in corrlation traces in case of a drifting clock.
This function <code class="docutils literal notranslate"><span class="pre">applies</span></code> the stretches. To correct for stretching
estimated with :class:<a href="#id5"><span class="problematic" id="id6">`</span></a>~miic.core.stretch_mod.time_stretch_estimate`you
need to apply negative stretching.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>corr_data</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>) – 2d ndarray containing the correlation functions that are
to be shifted.
One for each row.</p></li>
<li><p><strong>stretch</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>) – ndarray with stretch.shape[0] = corr_data.shape[0]
containing the stretches relative units.</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><strong>stretched_mat</strong>: stretched version of the input matrix</p>
</dd>
</dl>
</dd></dl>

</div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="dv.html" class="btn btn-neutral float-left" title="Reading and Handling of DV objects" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2020, C.S..

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>