

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>Module to Download and Read Waveform Data &mdash; SeisMIIC 0.1 documentation</title>
  

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script src="https://unpkg.com/mermaid/dist/mermaid.min.js"></script>
        <script >mermaid.initialize({startOnLoad:true});</script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="miic3.trace_data API" href="API.html" />
    <link rel="prev" title="Trace data" href="../trace_data.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../index.html" class="icon icon-home"> SeisMIIC
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../intro.html">Introduction: Noise Interferometry with Green’s Function Retrieval</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../trace_data.html">Trace data</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="../trace_data.html#routines-for-working-with-seismic-traces">Routines for working with seismic traces</a><ul class="current">
<li class="toctree-l3 current"><a class="current reference internal" href="#">Module to Download and Read Waveform Data</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#download-data">Download Data</a></li>
<li class="toctree-l4"><a class="reference internal" href="#access-data">Access Data</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="API.html"><code class="docutils literal notranslate"><span class="pre">miic3.trace_data</span></code> API</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../correlate.html">Compute and Handle Correlations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../corrdb.html">Save and Load Correlations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../monitor.html">Monitor Velocity Changes</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">SeisMIIC</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="../trace_data.html">Trace data</a> &raquo;</li>
        
      <li>Module to Download and Read Waveform Data</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../../_sources/modules/trace_data/waveform.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="mermaid">
            %%{init: { 'logLevel': 'debug', 'theme': 'base' } }%%
graph LR
    waveform[Get Data]:::active --&gt; correlate(Correlation)
    correlate --&gt;|save| corrdb[(CorrDB/hdf5)]
    corrdb --&gt; monitor
    monitor[Measure dv] --&gt;|save| dv{{DV}}
    click waveform &quot;../trace_data.html&quot; &quot;trace_data&quot;
    click correlate &quot;../correlate.html&quot; &quot;correlate&quot;
    click monitor &quot;../monitor.html&quot; &quot;monitor&quot;
    click corrdb &quot;../corrdb.html&quot; &quot;CorrDB&quot;
    classDef active fill:#f666, stroke-width:4px, stroke:#f06;
        </div><div class="section" id="module-to-download-and-read-waveform-data">
<h1>Module to Download and Read Waveform Data<a class="headerlink" href="#module-to-download-and-read-waveform-data" title="Permalink to this headline">¶</a></h1>
<p>The waveform module contains functions and classes that allow to read waveforms from a local database
or download waveform data from <em>FDSN servers</em> by using the <a class="reference external" href="https://docs.obspy.org/packages/autogen/obspy.clients.fdsn.mass_downloader.html">Obspy Mass Downloader</a>.
The downloaded data will then be written in a <em>seiscom data structure (SDS)</em>.
Both data download and management of the raw database are handled using a <a class="reference internal" href="API.html#miic3.trace_data.waveform.Store_Client" title="miic3.trace_data.waveform.Store_Client"><code class="xref py py-class docutils literal notranslate"><span class="pre">Store_Client</span></code></a> object.</p>
<div class="section" id="download-data">
<h2>Download Data<a class="headerlink" href="#download-data" title="Permalink to this headline">¶</a></h2>
<p>The recommended way to download continuous data for noise correlations is the method
<a class="reference internal" href="API.html#miic3.trace_data.waveform.Store_Client.download_waveforms_mdl" title="miic3.trace_data.waveform.Store_Client.download_waveforms_mdl"><code class="xref py py-func docutils literal notranslate"><span class="pre">download_waveforms_mdl()</span></code></a>. To use this method, we first need to initialise a <a class="reference internal" href="API.html#miic3.trace_data.waveform.Store_Client" title="miic3.trace_data.waveform.Store_Client"><code class="xref py py-class docutils literal notranslate"><span class="pre">Store_Client</span></code></a> object.
The code block below shows and example for downloading data from the <strong>IU.HRV</strong> station.</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">obspy.clients.fdsn</span> <span class="kn">import</span> <span class="n">Client</span>
<span class="kn">from</span> <span class="nn">obspy</span> <span class="kn">import</span> <span class="n">UTCDateTime</span>

<span class="kn">from</span> <span class="nn">miic3.trace_data.waveform</span> <span class="kn">import</span> <span class="n">Store_Client</span>

<span class="n">root</span> <span class="o">=</span> <span class="s1">&#39;/path/to/project/&#39;</span>
<span class="n">starttime</span> <span class="o">=</span> <span class="n">UTCDateTime</span><span class="p">(</span><span class="n">year</span><span class="o">=</span><span class="mi">1990</span><span class="p">,</span> <span class="n">julday</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">endtime</span> <span class="o">=</span> <span class="n">UTCDateTime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span>
<span class="n">network</span> <span class="o">=</span> <span class="s1">&#39;IU&#39;</span>
<span class="n">station</span> <span class="o">=</span> <span class="s1">&#39;HRV&#39;</span>


<span class="n">c</span> <span class="o">=</span> <span class="n">Client</span><span class="p">()</span>
<span class="n">sc</span> <span class="o">=</span> <span class="n">Store_Client</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">root</span><span class="p">,</span> <span class="n">read_only</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">sc</span><span class="o">.</span><span class="n">download_waveforms_mdl</span><span class="p">(</span>
    <span class="n">starttime</span><span class="p">,</span> <span class="n">endtime</span><span class="p">,</span> <span class="n">clients</span><span class="o">=</span><span class="p">[</span><span class="n">c</span><span class="p">],</span> <span class="n">network</span><span class="o">=</span><span class="n">network</span><span class="p">,</span>
    <span class="n">station</span><span class="o">=</span><span class="n">station</span><span class="p">,</span> <span class="n">location</span><span class="o">=</span><span class="s1">&#39;*&#39;</span><span class="p">,</span> <span class="n">channel</span><span class="o">=</span><span class="s1">&#39;*&#39;</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Instead of defining station and network codes, we could have used geographical coordinates
to decide which stations to download. To do that, define the parameters <code class="docutils literal notranslate"><span class="pre">minlon</span></code>, <code class="docutils literal notranslate"><span class="pre">maxlon</span></code>,
<code class="docutils literal notranslate"><span class="pre">minlat</span></code>, and <code class="docutils literal notranslate"><span class="pre">maxlat</span></code>.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><a class="reference internal" href="API.html#miic3.trace_data.waveform.Store_Client.download_waveforms_mdl" title="miic3.trace_data.waveform.Store_Client.download_waveforms_mdl"><code class="xref py py-func docutils literal notranslate"><span class="pre">download_waveforms_mdl()</span></code></a> requires a list as input
of clients.</p>
</div>
</div>
<div class="section" id="access-data">
<h2>Access Data<a class="headerlink" href="#access-data" title="Permalink to this headline">¶</a></h2>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If you just want to compute some noise correlations (i.e., Green’s function estimations), you
might not need this section.</p>
</div>
<p>Now, that we downloaded some waveform data, we might want to access it. This can as well be realised
using <a class="reference internal" href="API.html#miic3.trace_data.waveform.Store_Client" title="miic3.trace_data.waveform.Store_Client"><code class="xref py py-class docutils literal notranslate"><span class="pre">Store_Client</span></code></a>. In general, seismic data comes in two parts:
The waveform data in <em>.mseed</em> format and the Station Response information in <em>XML</em> format.
<a class="reference internal" href="API.html#miic3.trace_data.waveform.Store_Client" title="miic3.trace_data.waveform.Store_Client"><code class="xref py py-class docutils literal notranslate"><span class="pre">Store_Client</span></code></a> comes with several methods to fetch the two. There
are methods that will only read local data and methods that will check whether data is available locally
and, if not, download them from remote (i.e., the FDSN server that we defined when initialising the
<a class="reference internal" href="API.html#miic3.trace_data.waveform.Store_Client" title="miic3.trace_data.waveform.Store_Client"><code class="xref py py-class docutils literal notranslate"><span class="pre">Store_Client</span></code></a> object).</p>
<dl class="simple">
<dt>To access only already available data use:</dt><dd><ul class="simple">
<li><p>response information:</p>
<ul>
<li><p><a class="reference internal" href="API.html#miic3.trace_data.waveform.Store_Client.read_inventory" title="miic3.trace_data.waveform.Store_Client.read_inventory"><code class="xref py py-func docutils literal notranslate"><span class="pre">read_inventory()</span></code></a> to read all available response information.</p></li>
<li><p><code class="xref py py-attr docutils literal notranslate"><span class="pre">inventory</span></code> to access the pythonic inventory object
(see <a class="reference external" href="https://docs.obspy.org/packages/autogen/obspy.core.inventory.inventory.Inventory.html">obspy’s documentation</a> for available methods)</p></li>
</ul>
</li>
<li><p>waveform data:</p>
<ul>
<li><p><code class="xref py py-func docutils literal notranslate"><span class="pre">_load_local()</span></code> to load local data</p></li>
</ul>
</li>
</ul>
</dd>
<dt>If you would like to download missing data, use the following methods:</dt><dd><ul class="simple">
<li><p>Response Information:</p>
<ul>
<li><p><a class="reference internal" href="API.html#miic3.trace_data.waveform.Store_Client.select_inventory_or_load_remote" title="miic3.trace_data.waveform.Store_Client.select_inventory_or_load_remote"><code class="xref py py-func docutils literal notranslate"><span class="pre">select_inventory_or_load_remote()</span></code></a></p></li>
</ul>
</li>
<li><p>waveform data:</p>
<ul>
<li><p><a class="reference internal" href="API.html#miic3.trace_data.waveform.Store_Client.get_waveforms" title="miic3.trace_data.waveform.Store_Client.get_waveforms"><code class="xref py py-func docutils literal notranslate"><span class="pre">get_waveforms()</span></code></a></p></li>
</ul>
</li>
</ul>
</dd>
</dl>
<div class="section" id="getting-an-overview-of-your-database">
<h3>Getting an overview of your database<a class="headerlink" href="#getting-an-overview-of-your-database" title="Permalink to this headline">¶</a></h3>
<p>Once your database grows in size, you might not exactly know anymore, which data you have available.
There are a couple of functions to help you:</p>
<blockquote>
<div><ul class="simple">
<li><dl class="simple">
<dt><a class="reference internal" href="API.html#miic3.trace_data.waveform.Store_Client.get_available_stations" title="miic3.trace_data.waveform.Store_Client.get_available_stations"><code class="xref py py-func docutils literal notranslate"><span class="pre">get_available_stations()</span></code></a> returns all codes of stations</dt><dd><p>for which data is available (a network may or may not be defined).</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><code class="xref py py-func docutils literal notranslate"><span class="pre">_get_times()</span></code> returns the earliest and latest available</dt><dd><p>starttimes for a certain station.</p>
</dd>
</dl>
</li>
</ul>
</div></blockquote>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="API.html#miic3.trace_data.waveform.Store_Client" title="miic3.trace_data.waveform.Store_Client"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Store_Client</span></code></a></p></td>
<td><p>Client for request and local storage of waveform data</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="API.html#miic3.trace_data.waveform.FS_Client" title="miic3.trace_data.waveform.FS_Client"><code class="xref py py-obj docutils literal notranslate"><span class="pre">FS_Client</span></code></a></p></td>
<td><p>Request Client for reading MSEED files from file system</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="API.html#miic3.trace_data.waveform.read_from_filesystem" title="miic3.trace_data.waveform.read_from_filesystem"><code class="xref py py-obj docutils literal notranslate"><span class="pre">read_from_filesystem</span></code></a></p></td>
<td><p>Read data from a filesystem</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="API.html" class="btn btn-neutral float-right" title="miic3.trace_data API" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="../trace_data.html" class="btn btn-neutral float-left" title="Trace data" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2020, C.S..

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>